<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">

  <title>ã‚ï¼ã‚¹ãƒ¼ãƒ¢ï¼</title>
  <style>
    i {
      text-indent: 1em;
      background-repeat: no-repeat;
      background-position: left center;
      background-size: contain;
      display: inline-block;
      width: 1em;
      height: 1.1em;
    }

    .e1 {
      background-image: url("./img/1.png");
    }

    .e2 {
      background-image: url("./img/2.png");
    }

    .e3 {
      background-image: url("./img/3.png");
    }

    .e4 {
      background-image: url("./img/4.png");
    }

    .e5 {
      background-image: url("./img/5.png");
    }

    .e6 {
      background-image: url("./img/6.png");
    }

    .e7 {
      background-image: url("./img/7.png");
    }
  </style>
  <script>window.twttr = (function(d, s, id) {
  Â Â var js, fjs = d.getElementsByTagName(s)[0],
  Â Â Â Â t = window.twttr || {};
  Â Â if (d.getElementById(id)) return t;
  Â Â js = d.createElement(s);
  Â Â js.id = id;
  Â Â js.src = "https://platform.twitter.com/widgets.js";
  Â Â fjs.parentNode.insertBefore(js, fjs);
  Â 
  Â Â t._e = [];
  Â Â t.ready = function(f) {
  Â Â Â Â t._e.push(f);
  Â Â };
  Â 
  Â Â return t;
  }(document, "script", "twitter-wjs"));</script>
  <script>
    (function() {
      var suumo = [
        "ã‚â—ï¸ã‚¹ãƒ¼ãƒ¢â—ï¸<i class='e1'></i>",
        "ãƒ€ãƒ³<i class='e2'></i>", "ãƒ€ãƒ³<i class='e2'></i>",
        "ãƒ€ãƒ³<i class='e2'></i>", "ã‚·ãƒ£ãƒ¼ãƒ³<i class='e3'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ã€œã€œã€œãƒ¢<i class='e5'></i><i class='e4'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ãƒ¢<i class='e4'></i>", "ã‚¹ãƒ¢<i class='e1'></i>",
        "ã‚¹ã€œã€œã€œãƒ¢<i class='e6'></i><i class='e7'></i>"
      ];
      var suumo2 = [
        "ã‚â—ï¸ ã‚¹ãƒ¼ãƒ¢â—ï¸ğŸŒš",
        "ãƒ€ãƒ³ğŸ’¥","ãƒ€ãƒ³ğŸ’¥","ãƒ€ãƒ³ğŸ’¥","ã‚·ãƒ£ãƒ¼ãƒ³ğŸ¶",
        "ã‚¹ãƒ¢ğŸŒ","ã‚¹ãƒ¢ğŸŒš","ã‚¹ãƒ¢ğŸŒ","ã‚¹ãƒ¢ğŸŒš",
        "ã‚¹ãƒ¢ğŸŒ","ã‚¹ãƒ¢ğŸŒš","ã‚¹ã€œã€œã€œãƒ¢â¤´ğŸŒ",
        "ã‚¹ãƒ¢ğŸŒš","ã‚¹ãƒ¢ğŸŒ","ã‚¹ãƒ¢ğŸŒš","ã‚¹ãƒ¢ğŸŒ",
        "ã‚¹ãƒ¢ğŸŒš","ã‚¹ãƒ¢ğŸŒ","ã‚¹ã€œã€œã€œãƒ¢â¤µğŸŒ"
      ];
      var song = new Array(suumo.length);Â 
      var song_p = 0;

      // from:http://curtaincall.weblike.jp/portfolio-web-sounder/webaudioapi-basic/demos/demo-08
      // http://curtaincall.weblike.jp/portfolio-web-sounder/webaudioapi-basic/audio
      Â Â Â Â 
      var onDOMContentLoaded = function() {Â Â Â Â Â Â Â Â Â 
        window.AudioContext = window.AudioContext || window.webkitAudioContext;Â Â Â Â Â Â Â Â Â 
        try {Â Â Â Â Â Â Â Â Â Â Â Â  // Create the instance of AudioContext
          Â Â Â Â Â Â Â Â Â Â Â Â 
          var context = new AudioContext();Â Â Â Â Â Â Â Â 
        } catch (error) {Â Â Â Â Â Â Â Â Â Â Â Â 
          window.alert(error.message + ' : Please use Chrome or Safari.');Â Â Â Â Â Â Â Â Â Â Â Â 
          return;Â Â Â Â Â Â Â Â 
        }Â Â Â Â Â Â Â Â Â  // for legacy browsers
        Â Â Â Â Â Â Â Â 
        context.createGain = context.createGain || context.createGainNode;Â Â Â Â Â Â Â Â Â  // Create the instance of GainNode
        Â Â Â Â Â Â Â Â 
        var gain = context.createGain();Â Â Â Â Â Â Â Â Â  // for the instances of AudioBuffer
        Â Â Â Â Â Â Â Â 
        var buffers = new Array(suumo.length);Â Â Â Â Â Â Â Â Â  // for the instances of AudioBufferSourceNode
        Â Â Â Â Â Â Â Â 
        var sources = new Array(suumo.length);Â Â Â Â Â Â Â Â Â 
        var interval;Â  // sec
        Â Â Â Â Â Â Â Â Â  // Create original event
        Â Â Â Â Â Â Â Â 
        var event = document.createEvent('Event');Â Â Â Â Â Â Â Â 
        event.initEvent('complete', true, true);Â Â Â Â Â Â Â Â Â  // Get ArrayBuffer by Ajax
        Â Â Â Â Â Â Â Â 
        var load = function(url, index) {Â Â Â Â Â Â Â Â Â Â Â Â 
          var xhr = new XMLHttpRequest();Â Â Â Â Â Â Â Â Â Â Â Â Â  // Timeout (1 minutes)
          Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.timeout = 30000;Â Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.ontimeout = function() {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
            window.alert('Timeout.');Â Â Â Â Â Â Â Â Â Â Â Â 
          };Â Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.onerror = function() {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  //window.alert('Ajax Error.');
            Â Â Â Â Â Â Â Â Â Â Â Â };Â Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.onload = function() {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
            if (xhr.status === 200) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              var arrayBuffer = xhr.response;Â  // Get ArrayBuffer
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              if (arrayBuffer instanceof ArrayBuffer) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // The 2nd argument for decodeAudioData
                Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                var successCallback = function(audioBuffer) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Get the instance of AudioBuffer
                  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  buffers[index] = audioBuffer;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // The loading instances of AudioBuffer has completed ?
                  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  for (var i = 0, len = buffers.length; i < len; i++) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    if (buffers[i] === undefined) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                      return;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // dispatch 'complete' event
                  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  document.querySelector('button').dispatchEvent(event);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                };Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // The 3rd argument for decodeAudioData
                Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                var errorCallback = function(error) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  if (error instanceof Error) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    window.alert(error.message);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  } else {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                    window.alert('Error : "decodeAudioData" method.');Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                  }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                };Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Create the instance of AudioBuffer (Asynchronously)
                Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
                context.decodeAudioData(arrayBuffer, successCallback, errorCallback);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              }Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
            }Â Â Â Â Â Â Â Â Â Â Â Â 
          };Â Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.open('GET', url, true);Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.responseType = 'arraybuffer';Â Â Â Â Â Â Â Â Â Â Â Â 
          xhr.send(null);Â Â Â Â Â Â Â Â 
        };Â Â Â Â Â Â Â Â Â 
        for (var i = 0, len = suumo.length; i < len; i++) {Â Â Â Â Â Â Â Â Â Â Â Â 
          load('./audio/suumo_' + i + ".mp3", i);Â Â Â Â Â Â Â Â 
        }Â 
        var buttons = document.querySelectorAll('button');
        for (var i = 0; i < buttons.length; i++) {
          buttons[i].addEventListener('click', function() {
            // Get base time
            var t0 = context.currentTime;

            var text = "";
            song_p = 0;

            //https://bost.ocks.org/mike/shuffle/
            var m = suumo.length,
              t, i;
            for (i = 0; i < m; i++) {
              song[i] = i;
            }
            if (this.id == "random") {
              // While there remain elements to shuffleâ€¦
              while (m) {
                // Pick a remaining elementâ€¦
                i = Math.floor(Math.random() * m--);

                // And swap it with the current element.
                t = song[m];
                song[m] = song[i];
                song[i] = t;
              }
            }
            m = suumo.length;
            for (i = 0; i < m; i++) {
              var sumomi = document.createElement("span");
              sumomi.setAttribute("id", "b"+i);
              document.getElementById("box").appendChild(sumomi);
              document.getElementById("b"+i).innerHTML = ""+suumo[song[i]];
              text += suumo2[song[i]];
            }
            document.getElementById('b0').style.background = 'rgba(255,0,0,0.5)';
Â Â Â Â Â Â 
            for (var i = 0, len = buffers.length; i < len; i++) {Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Create the instance of AudioBufferSourceNode
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i] = context.createBufferSource();Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // for legacy browsers
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].start = sources[i].start || sources[i].noteGrainOn;Â  // noteGrainOn
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].stopÂ  = sources[i].stopÂ  || sources[i].noteOff;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // Set the instance of AudioBuffer
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].buffer = buffers[song[i]];Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // AudioBufferSourceNode (Input) -> GainNode (Master Volume) -> AudioDestinationNode (Output)
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].connect(gain);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              gain.connect(context.destination);

              interval = sources[i].buffer.duration - 0.03; //ãƒ•ãƒ©ã‚¤ãƒ³ã‚°
              Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].start(t0, 0, interval);Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
              sources[i].stop(t0 + interval);
              t0 += interval;
              sources[i].onended = function(){
                document.getElementById('b'+song_p).style.background = 'rgba(255,255,255,1.0)';
                if(song_p < suumo.length){
                  document.getElementById('b'+(song_p+1)).style.background = 'rgba(255,0,0,0.5)';
                }
                song_p++;
              }Â Â Â Â Â Â Â Â Â Â Â Â 
            }Â Â Â 
          }, false);
        }Â 
      };Â Â Â Â Â 
      if ((document.readyState === 'interactive') || (document.readyState === 'complete')) {Â Â Â Â Â Â Â Â 
        onDOMContentLoaded();Â Â Â Â 
      } else {Â Â Â Â Â Â Â Â 
        document.addEventListener('DOMContentLoaded', onDOMContentLoaded, true);Â Â Â Â 
      }Â 
    })();
  </script>
</head>

<body>
  <button type="button" id="normal" style="width:600px;height:80px;font-size:45px;">ã‚ï¼ã‚¹ãƒ¼ãƒ¢ï¼(ãµã¤ã†)</button>
  <button type="button" id="random" style="width:600px;height:80px;font-size:45px;">ã‚ï¼ã‚¹ãƒ¼ãƒ¢ï¼(ãƒ©ãƒ³ãƒ€ãƒ )</button>
  <div id="box" style="font-size:2em;"></div>
  <div id="sorry" style="color:#888">æ­£ç›´è‘—ä½œæ¨©etcçš„ã«ã„ã‚ã„ã‚ã‚¢ã‚¦ãƒˆã§ã™ã€‚</div>
  <a class="twitter-share-button" href="https://twitter.com/share" data-url="http://hnakai0909.github.io/works/suumo/" data-size="large">
Tweet</a>
</body>

</html>
