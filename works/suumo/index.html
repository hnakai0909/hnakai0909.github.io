<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">

  <title>ã‚ï¼ã‚¹ãƒ¼ãƒ¢ï¼</title>

  <script>
  (function() {
  Â    // from:http://curtaincall.weblike.jp/portfolio-web-sounder/webaudioapi-basic/demos/demo-08
  Â Â Â Â var onDOMContentLoaded = function() {
  Â 
  Â Â Â Â Â Â Â Â window.AudioContext = window.AudioContext || window.webkitAudioContext;
  Â 
  Â Â Â Â Â Â Â Â try {
  Â Â Â Â Â Â Â Â Â Â Â Â // Create the instance of AudioContext
  Â Â Â Â Â Â Â Â Â Â Â Â var context = new AudioContext();
  Â Â Â Â Â Â Â Â } catch (error) {
  Â Â Â Â Â Â Â Â Â Â Â Â window.alert(error.message + ' : Please use Chrome or Safari.');
  Â Â Â Â Â Â Â Â Â Â Â Â return;
  Â Â Â Â Â Â Â Â }
  Â 
  Â Â Â Â Â Â Â Â // for legacy browsers
  Â Â Â Â Â Â Â Â context.createGain = context.createGain || context.createGainNode;
  Â 
  Â Â Â Â Â Â Â Â // Create the instance of GainNode
  Â Â Â Â Â Â Â Â var gain = context.createGain();
  Â 
          var suumo = [
            "ã‚â—ï¸ã‚¹ãƒ¼ãƒ¢â—ï¸ğŸŒš",
            "ãƒ€ãƒ³ğŸ’¥", "ãƒ€ãƒ³ğŸ’¥", "ãƒ€ãƒ³ğŸ’¥", "ã‚·ãƒ£ãƒ¼ãƒ³ğŸ¶",
            "ã‚¹ãƒ¢ğŸŒ", "ã‚¹ãƒ¢ğŸŒš", "ã‚¹ãƒ¢ğŸŒ", "ã‚¹ãƒ¢ğŸŒš",
            "ã‚¹ãƒ¢ğŸŒ", "ã‚¹ãƒ¢ğŸŒš", "ã‚¹ã€œã€œã€œãƒ¢â¤´ğŸŒ",
            "ã‚¹ãƒ¢ğŸŒš", "ã‚¹ãƒ¢ğŸŒ", "ã‚¹ãƒ¢ğŸŒš", "ã‚¹ãƒ¢ğŸŒ",
            "ã‚¹ãƒ¢ğŸŒš", "ã‚¹ãƒ¢ğŸŒ", "ã‚¹ã€œã€œã€œãƒ¢â¤µğŸŒ"
          ];
          var song = new Array(suumo.length);
          var text = "";

          //https://bost.ocks.org/mike/shuffle/
          var m = suumo.length, t, i;
          for (i = 0; i < m; i++) {
            song[i] = i;
          }
          // While there remain elements to shuffleâ€¦
          while (m) {
            // Pick a remaining elementâ€¦
            i = Math.floor(Math.random() * m--);

            // And swap it with the current element.
            t = song[m];
            song[m] = song[i];
            song[i] = t;
          }
          m = suumo.length;
          for (i = 0; i < m; i++) {
            text += suumo[i];
          }
Â 
  Â Â Â Â Â Â Â Â // for the instances of AudioBuffer
  Â Â Â Â Â Â Â Â var buffers = new Array(suumo.length);
  Â 
  Â Â Â Â Â Â Â Â // for the instances of AudioBufferSourceNode
  Â Â Â Â Â Â Â Â var sources = new Array(suumo.length);
  Â 
  Â Â Â Â Â Â Â Â var interval;Â  // sec
  Â 
  Â Â Â Â Â Â Â Â // Create original event
  Â Â Â Â Â Â Â Â var event = document.createEvent('Event');
  Â Â Â Â Â Â Â Â event.initEvent('complete', true, true);
  Â 
  Â Â Â Â Â Â Â Â // Get ArrayBuffer by Ajax
  Â Â Â Â Â Â Â Â var load = function(url, index) {
  Â Â Â Â Â Â Â Â Â Â Â Â var xhr = new XMLHttpRequest();
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â // Timeout (1 minutes)
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.timeout = 60000;
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.ontimeout = function() {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â window.alert('Timeout.');
  Â Â Â Â Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.onerror = function() {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â window.alert('Ajax Error.');
  Â Â Â Â Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.onload = function() {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (xhr.status === 200) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â var arrayBuffer = xhr.response;Â  // Get ArrayBuffer
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (arrayBuffer instanceof ArrayBuffer) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // The 2nd argument for decodeAudioData
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â var successCallback = function(audioBuffer) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // Get the instance of AudioBuffer
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â buffers[index] = audioBuffer;
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // The loading instances of AudioBuffer has completed ?
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â for (var i = 0, len = buffers.length; i < len; i++) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (buffers[i] === undefined) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â return;
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // dispatch 'complete' event
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â document.querySelector('button').dispatchEvent(event);
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // The 3rd argument for decodeAudioData
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â var errorCallback = function(error) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (error instanceof Error) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â window.alert(error.message);
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } else {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â window.alert('Error : "decodeAudioData" method.');
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // Create the instance of AudioBuffer (Asynchronously)
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â context.decodeAudioData(arrayBuffer, successCallback, errorCallback);
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â Â Â Â Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.open('GET', url, true);
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.responseType = 'arraybuffer';
  Â Â Â Â Â Â Â Â Â Â Â Â xhr.send(null);
  Â Â Â Â Â Â Â Â };
  Â 
  Â Â Â Â Â Â Â Â for (var i = 0, len = suumo.length; i < len; i++) {
  Â Â Â Â Â Â Â Â Â Â Â Â load('./audio/suumo_' + i + ".mp3", i);
  Â Â Â Â Â Â Â Â }
  Â 
  Â Â Â Â Â Â Â Â document.querySelector('button').addEventListener('complete', function() {
  Â Â Â Â Â Â Â Â Â Â Â 
  Â Â Â Â Â Â Â Â Â Â Â Â this.addEventListener('click', function() {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // Get base time
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â var t0 = context.currentTime;
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â for (var i = 0, len = buffers.length; i < len; i++) {
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // Create the instance of AudioBufferSourceNode
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i] = context.createBufferSource();
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // for legacy browsers
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].start = sources[i].start || sources[i].noteGrainOn;Â  // noteGrainOn
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].stopÂ  = sources[i].stopÂ  || sources[i].noteOff;
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // Set the instance of AudioBuffer
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].buffer = buffers[song[i]];
  Â 
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // AudioBufferSourceNode (Input) -> GainNode (Master Volume) -> AudioDestinationNode (Output)
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].connect(gain);
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â gain.connect(context.destination);

                      interval = sources[i].buffer.duration - 0.03; //ãƒ•ãƒ©ã‚¤ãƒ³ã‚°
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].start(t0, 0, interval);
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sources[i].stop(t0 + interval);
                      t0 += interval;
  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
  Â Â Â Â Â Â Â Â Â Â Â Â }, false);
  Â 
  Â Â Â Â Â Â Â Â }, false);
          document.getElementById("box").innerHTML = "" + text;
  Â Â Â Â };
  Â 
  Â Â Â Â if ((document.readyState === 'interactive') || (document.readyState === 'complete')) {
  Â Â Â Â Â Â Â Â onDOMContentLoaded();
  Â Â Â Â } else {
  Â Â Â Â Â Â Â Â document.addEventListener('DOMContentLoaded', onDOMContentLoaded, true);
  Â Â Â Â }
  Â 
  })();
  </script>
</head>

<body>
  <button type="button" style="width:400px;height:80px;font-size:60px;">ã‚ï¼ã‚¹ãƒ¼ãƒ¢ï¼</button>
  <div id="box"></div>
</body>

</html>
